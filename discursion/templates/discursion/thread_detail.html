{% extends 'discursion/base.html' %}
{% load gravatar_tags %}

{% block title %} | {{ thread.name }}{% endblock %}

{% block breadcrumb %}
    {% for f in thread.forum.get_ancestors %}
        <span class="sep">&rsaquo;</span>
        <a href="{{ f.get_absolute_url }}">{{ f.name }}</a>
    {% endfor %}
    <span class="sep">&rsaquo;</span>
    <a href="{{ thread.forum.get_absolute_url }}">{{ thread.forum.name }}</a>
    <span class="sep">&rsaquo;</span>
    <span>{{ thread.name }}</span>
{% endblock %}

{% block content_container %}
<div class="row">
    <div class="column grid_12">
        <h3 class="bold">{{ thread.name }}</h3>
    </div>
    <div class="column grid_4 right">
        <a href="{{ thread.forum.get_new_thread_url }}">[new thread]</a>
        <a href="{{ thread.get_add_reply_url }}">[add reply]</a>
    </div>
</div>

<div class="row posts">
    {% for post in thread.posts %}
    <div class=" column grid_16 {% cycle 'primary' 'secondary' %}">
        <div class="row meta">
            <div class="column grid_8">
                <div class="padding"><a class="bold" href="{{ post.author.get_absolute_url }}">{{ post.author.username }}</a></div>
            </div>
            <div class="column grid_8 right">
                <div class="padding">[edit] [delete]</div>
            </div>
        </div>
        <div class="row">
            <div class="column grid_3 center">
                <div class="padding">
                <img src="{% gravatar_for_user post.author %}" class="gravatar" alt="{{ post.author.username }}'s Gravatar" />
                </div>
            </div>
            <div class="column grid_13">
                <div class="small">Posted {{ post.created_on|timesince }} ago</div>
                {{ post.message_rendered|safe }}
            </div>
        </div>
    </div>
    <div class="column grid_16"><hr /></div>
    {% endfor %}
</div>

<div class="row">
    <div class="column grid_2">&nbsp;</div>
    <div class="column grid_12">
        <form action="{{ thread.get_add_reply_url }}" method="post">{% csrf_token %}
            <table class="form">
                <thead>
                    <tr>
                        <th colspan="2">Quick Reply</th>
                    </tr>
                </thead>
                {{ reply_form.as_table }}
                <tr>
                    <th></th>
                    <td><input type="submit" value="Quick Reply" /></td>
                </tr>
            </table>
        </form>
    </div>
    <div class="column grid_2">&nbsp;</div>
</div>

{% endblock %}
